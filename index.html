<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>訪客瀏覽器</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden;
    }
    #guestWebview {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>
<body>
  <webview id="guestWebview" partition="persist:guest" src="https://www.google.com" allowpopups></webview>

  <script>
    // --------------------------
    // 檢查是否在 Electron 環境
    const isElectron = navigator.userAgent.toLowerCase().includes('electron');
    if (!isElectron) {
      document.body.innerHTML = "<h2>請使用 Electron 執行此檔案</h2>";
      throw new Error("Not running inside Electron");
    }

    const { app, BrowserWindow } = require('electron').remote || require('@electron/remote');
    const path = require('path');

    // --------------------------
    // 建立 BrowserWindow
    function createWindow() {
      const win = new BrowserWindow({
        width: 1200,
        height: 800,
        webPreferences: {
          nodeIntegration: true,
          contextIsolation: false,
          webviewTag: true
        }
      });
      win.loadFile(__filename); // 載入自己
    }

    if (app) {
      app.whenReady().then(createWindow);
      app.on('window-all-closed', () => {
        if (process.platform !== 'darwin') app.quit();
      });
    }

    // --------------------------
    // WebView 事件
    const webview = document.getElementById('guestWebview');
    webview.addEventListener('did-start-loading', () => console.log('訪客 WebView 開始載入'));
    webview.addEventListener('did-finish-load', () => console.log('訪客 WebView 載入完成'));
  </script>
</body>
</html>